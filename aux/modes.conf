# $Id: modes.conf,v 1.11 2022/06/12 15:32:28 karn Exp $
# mode definitions for KA9Q software receiver, iniparser format, April 2022
# updated Aug 2023 so frequency entries (samprate, low, high, shift) are parsed with parse_frequency() in misc.c

# Use decimal points for entries in Hz, or the letters 'k', 'm' or 'g' as the decimal point for numbers
# in kHz, MHz or GHz.
[pm]
# Phase modulation, i.e., classic ham narrow band "FM" voice
demod = fm
samprate = 24k
low =  -8k
high = +8k
squelchtail = 0
threshold-extend = yes ; PM assumes voice mode, so enable this

[npm]
# Same as pm but narrower
demod = fm
samprate = 24k
low =  -6k250
high = +6k250
squelchtail = 0
threshold-extend = yes ; PM assumes voice mode, so enable this

[fm]
# standard flat narrow band FM with no de-emphasis, useful for digital modes
demod = fm
samprate = 24k
low =  -8k
high = +8k
deemph-tc = 0
deemph-gain = 0
threshold-extend = no ; dont interfere with packet, digital, etc

[nfm]
# same as fm but narrower
demod = fm
samprate = 24k
low =  -6k25
high = +6k250
deemph-tc = 0
deemph-gain = 0
threshold-extend = no ; dont interfere with packet, digital, etc

[wfm]
# wideband broadcast FM stereo. Output forced to 48 kHz stereo; defaults to North American de-emphasis time constants
demod = wfm
samprate = 384k
low =  -100k
high = +100k
threshold-extend = no ; not implemented

[am]
# Amplitude modulation
# Note: completely flat, passes DC (i.e., the carrier)
demod = linear
samprate = 12k
low = -5k
high = 5k
recovery-rate = 50
hang-time = 0
envelope = yes

[cam]
# Coherent modulation - AM with carrier tracking. Carrier lock squelch is automatically enabled.
demod = linear
samprate = 12k
low = -5k
high = 5k
recovery-rate = 50
hang-time = 0
pll = yes # also enables squelch! Set squelch open threshold to -999 dB to force it open

[ame]
# Enhanced AM with carrier & upper sideband only (e.g., CHU)
demod = linear
samprate = 12k
low =  -100.0
high = +5k
recovery-rate = 50
hang-time = 0
pll = yes

[iq]
# Raw quadrature (I/Q) output, usually for further demodulation
demod = linear
samprate = 12k
low =  -5k
high = +5k
channels = 2

[cwu]
# CW on bands that use USB voice.
# Signal is centered at DC (frequency readout is correct) and then shifted up 500 Hz so you can hear it.
# Switching between USB and CWU keeps the same audio tone while changing the filter and shifting the frequency display
demod = linear
samprate = 12k
low =  -200.0
high = +200.0
shift = +500.0
hang-time = 0.2

[cwl]
# Same as cwu except for bands that use LSB voice
demod = linear
samprate = 12k
low =  -200.0
high = +200.0
shift = -500.0
hang-time = 0.2

[usb]
# Classic upper sideband, with good low frequency response
demod = linear
samprate = 12k
low =    +50.0
high = +3k

[lsb]
# Classic lower sideband, with good low frequency response
demod = linear
samprate = 12k
low =  -3k
high =   -50.0

[dsb]
# Double sideband with suppressed carrier; uses squaring PLL to recover carrier
# Little used, so moved to the end
demod = linear
samprate = 12k
low =  -5k
high = +5k
square = yes

[amsq]
# envelope detected AM with carrier squelch (e.g., aviation, CB)
# same as cme except passes both sidebands
# PLL loop bandwidth may require adjustment to track large frequency errors on short transmissions
demod = linear
samprate = 12k
low = -3k
high = +3k
recovery-rate = 50
hang-time = 0
pll = yes
squelch-open = 8
squelch-close = 7

[wspr]
# Same as USB but with disabled AGC to allow for noise measurements
demod = linear
samprate = 12k
low = +50.0
high = +3k
agc = 0
gain = 60

[spectrum]
# experimental spectrum analysis
demod = spectrum
samprate = 48k # not really used
low = 0 # not really used
high = 48k # not really used

# List of all parameters and their defaults

# Applicable to all three demodulators (Linear/FM/WFM)
#kaiser-beta = 11    # Kaiser window rolloff filter. 0 = no windowing; larger numbers improve sidelobes but wider transitions
#low = -5k           # Lower edge of channel filter, Hz. Stay well above half the sample rate to avoid Gibbs ringing in output
#high = 5k           # Upper edge of channel filter, Hz. Stay well below half the sample rate to avoid Gibbs ringing in output
#squelch-open = 8.0  # dB - for FM, and for AM modes with PLL enabled to track carrier. Use -999 dB to force squelch open
#squelch-close = 7.0 # dB - the difference provides some hysteresis so the squelch doesn't flap too much
#squelchtail = 1     # time (blocks) squelch is kept open after signal disappears. 0 suppresses noise burst but may cut packet tails
	             # i.e., use 0 for packet, 1 for voice
#headroom = -15.0    # dBFS average output power target for AGC (linear) or FM (target for full deviation)

#Applicable to linear demod only
#shift = 0.0          # Hz - Shift this amount after conversion to baseband and filtering. Mainly for CW modes
#recovery-rate = 20.0 # AGC recovery rate in dB/sec
#hang-time = 1.1      # AGC hang time (sec) after signal disappears before gain recovery starts
#threshold = -15.0    # Output level, in dB relative to headroom, below which gain will not be increased for weak signals
	              # ie., on noise the output level is headroom - threshold = -30 dBFS
		      # as level increases the output level increases to headroom (-15 dBFS), then gain reduces to keep it there
#gain = 50.0          # dB. The AGC immediately changes this when it's on
#envelope = no        # Use the envelope detector, i.e., conventional AM
#pll = no             # Carrier tracking loop. Squelches output when unlocked
#square = no          # Carrier tracking loop with squaring, recovers carrier from DSB-AM or BPSK
#conj = no	      # Originally enabled ISB (independent sideband), needs to be re-implemented
#agc = yes	      # Enable AGC in linear modes. Controlled by recovery-rate, hang-time, threshold and headroom
#pll-bw = 10	      # PLL loop filter bandwidth, Hz

#Applicable to FM demodulator only
#channels = 1
#gain = 1.0          # Depends on bandwidth and sample rate - automatically set, not really applicable
#deemph-tc = 530.5   # De-emphasis time constant in microseconds; 530.5 us corresponds to a 300 Hz corner frequency
#deemph-gain = 12.0  # dB, empirical, makes loudness same as flat FM
#threshold-extend = no # Experimental threshold extension scheme, suppresses "popcorn" noise near threshold


#Applicable to WFM demodulator only
#channels = 2 (forced)
# downconverter samprate forced to 384k, output forced to 48k stereo
#gain = 1.0          # depends on bandwidth and sample rate, not really relevant
#deemph-tc = 75.0    # microseconds; change to 50.0 outside North America & Korea
#deemph-gain = 0.0   # dB, not necessary for WFM because of high corner frequency
