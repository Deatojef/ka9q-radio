\doxysection{/\+Users/karn/src/ka9q-\/radio/pcmrecord.c File Reference}
\hypertarget{pcmrecord_8c}{}\label{pcmrecord_8c}\index{/Users/karn/src/ka9q-\/radio/pcmrecord.c@{/Users/karn/src/ka9q-\/radio/pcmrecord.c}}


Record, stream, or launch commands with RTP streams as input.  


{\ttfamily \#include $<$assert.\+h$>$}\newline
{\ttfamily \#include $<$errno.\+h$>$}\newline
{\ttfamily \#include $<$limits.\+h$>$}\newline
{\ttfamily \#include $<$string.\+h$>$}\newline
{\ttfamily \#include $<$stdio.\+h$>$}\newline
{\ttfamily \#include $<$unistd.\+h$>$}\newline
{\ttfamily \#include $<$fcntl.\+h$>$}\newline
{\ttfamily \#include $<$sys/stat.\+h$>$}\newline
{\ttfamily \#include $<$poll.\+h$>$}\newline
{\ttfamily \#include $<$sysexits.\+h$>$}\newline
{\ttfamily \#include $<$signal.\+h$>$}\newline
{\ttfamily \#include $<$getopt.\+h$>$}\newline
{\ttfamily \#include $<$inttypes.\+h$>$}\newline
{\ttfamily \#include $<$ogg/ogg.\+h$>$}\newline
{\ttfamily \#include "{}misc.\+h"{}}\newline
{\ttfamily \#include "{}attr.\+h"{}}\newline
{\ttfamily \#include "{}multicast.\+h"{}}\newline
{\ttfamily \#include "{}radio.\+h"{}}\newline
Include dependency graph for pcmrecord.\+c\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{pcmrecord_8c__incl}
\end{center}
\end{figure}
\doxysubsubsection*{Data Structures}
\begin{DoxyCompactItemize}
\item 
struct \mbox{\hyperlink{structwav}{wav}}
\item 
struct \mbox{\hyperlink{structsession}{session}}
\item 
struct \mbox{\hyperlink{structsession_1_1reseq}{session\+::reseq}}
\end{DoxyCompactItemize}
\doxysubsubsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\Hypertarget{pcmrecord_8c_a369266c24eacffb87046522897a570d5}\label{pcmrecord_8c_a369266c24eacffb87046522897a570d5} 
\#define {\bfseries \+\_\+\+GNU\+\_\+\+SOURCE}~1
\item 
\Hypertarget{pcmrecord_8c_abe5fdf22c5dfb8f47170fb14ed753bcc}\label{pcmrecord_8c_abe5fdf22c5dfb8f47170fb14ed753bcc} 
\#define {\bfseries bswap\+\_\+16}(value)~((((value) \& 0xff) $<$$<$ 8) \texorpdfstring{$\vert$}{|} ((value) $>$$>$ 8))
\item 
\Hypertarget{pcmrecord_8c_ac3146f1e9227301bb4aa518f4d336cee}\label{pcmrecord_8c_ac3146f1e9227301bb4aa518f4d336cee} 
\#define {\bfseries BUFFERSIZE}~(8192)
\item 
\Hypertarget{pcmrecord_8c_a3fbdc522b9eb2a9fd2e66bfb75bf2ba1}\label{pcmrecord_8c_a3fbdc522b9eb2a9fd2e66bfb75bf2ba1} 
\#define {\bfseries RESEQ}~64
\end{DoxyCompactItemize}
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\Hypertarget{pcmrecord_8c_a2d664655023677e675b29cb16c14c697}\label{pcmrecord_8c_a2d664655023677e675b29cb16c14c697} 
int {\bfseries session\+\_\+file\+\_\+init} (struct \mbox{\hyperlink{structsession}{session}} \texorpdfstring{$\ast$}{*}sp, struct sockaddr const \texorpdfstring{$\ast$}{*}sender)
\item 
\Hypertarget{pcmrecord_8c_a0ddf1224851353fc92bfbff6f499fa97}\label{pcmrecord_8c_a0ddf1224851353fc92bfbff6f499fa97} 
int {\bfseries main} (int argc, char \texorpdfstring{$\ast$}{*}argv\mbox{[}$\,$\mbox{]})
\end{DoxyCompactItemize}
\doxysubsubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
\Hypertarget{pcmrecord_8c_a95f627d7054b1abbffa2c6ea19bf05db}\label{pcmrecord_8c_a95f627d7054b1abbffa2c6ea19bf05db} 
int {\bfseries Verbose}
\item 
\Hypertarget{pcmrecord_8c_aab3f01aad6add6744bd3ce0f67ca2047}\label{pcmrecord_8c_aab3f01aad6add6744bd3ce0f67ca2047} 
const char \texorpdfstring{$\ast$}{*} {\bfseries App\+\_\+path}
\item 
\Hypertarget{pcmrecord_8c_a673cf26653a614942c81564fe9bfdb05}\label{pcmrecord_8c_a673cf26653a614942c81564fe9bfdb05} 
int {\bfseries Mcast\+\_\+ttl}
\item 
\Hypertarget{pcmrecord_8c_ab157335085f4e080fb32fc3416be4f10}\label{pcmrecord_8c_ab157335085f4e080fb32fc3416be4f10} 
struct sockaddr\+\_\+storage {\bfseries Metadata\+\_\+dest\+\_\+socket}
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Record, stream, or launch commands with RTP streams as input. 

\begin{DoxyAuthor}{Author}
Phil Karn, KA9Q \begin{DoxyVerb}This program reads one or more RTP streams from a multicast group and either writes them into a file, streams (one of them) onto standard output, or invokes a command for each stream and pipes the RTP data into it. PCM streams are written as-is (except that big-endian PCM is converted to little-endian). Opus streams are placed in a standard Ogg container.

Command-line options:
 --stdout | --catmode | -c: write one stream to stdout. If --ssrc is not specified, selects the first one found and ignores the rest
 --directory | -d <directory>: directory root in which to write files<
 --exec | -e '<command args ...>': Execute the specified command for each stream and pipe to it. Several macros expanded as shown when found in the arguments:
        $$: insert a literal '$'
        $d: description string from the radiod front end
        $h: receive frequency in decimal hertz
        $k: receive frequency in decimal kilohertz
        $m: receive frequency in decimal megahertz
        $c: number of channels (1 or 2)
        $r: sample rate, integer Hz
        $s: ssrc (unsigned decimal integer)

 --flush|-f: Flush after each received packet. Increases Ogg container overhead; little need for this writing files
 --jt|-j: Use K1JT format file names
 --locale <locale>: Set locale. Default is $LANG
 --mintime|--minfiletime|-m: minimum file duration, in sec. Files shorter than this are deleted when closed
 --raw|-r: Don't emit .WAV header for PCM files; ignored with Opus (Ogg is needed to delimit frames in a stream)
 --subdirectories|--subdirs|-s': Create subdirectories when writing files: ssrc/year/month/day/filename
 --timeout|-t <seconds>: Close file after idle period (default 20 sec)
 --verbose|-v: Increase verbosity level
 --lengthlimit|--limit|-L <seconds>: maximum file duration, seconds. When new file is created, round down to previous start of interval and pad with silence (for JT decoding)
 --ssrc <ssrc>: Select one SSRC (recommended for --stdout)
 --version|-V: display command version
\end{DoxyVerb}
 
\end{DoxyAuthor}
