Configuring *ka9q-radio* to use the RX-888 MkII
===============================================
v1.0, August 2023
Phil Karn, KA9Q
---------------

Note: *ka9q-radio* was substantially restructured during the summer of 2023 to merge the front end
drivers into *radiod*. The drivers are no longer separate programs using multicast IP to communicate
with *radiod*. This considerably improves performance and simplifies configuration; what used to be a separate config file
(e.g., */etc/radio/airspyd.conf*) is now a section in the *radiod* configuration file.

Here is an excerpt of the relevant sections from one of my own *radiod* config files for the RX888 MkII.
It is in 'ini' format.

[global]  
hardware = rx888
status = hf.local

[rx888]  
device = rx888  
description = "g5rv on rx888 @ ka9q"
gain = +10


The sections defining groups of receiver channels are omitted. See **ka9q-radio.md** for details on the options
for those sections.

Multiple instances of *radiod* can run on the same system, provided each has its own front end (they cannot be shared).
You can have as many as you want, subject to your CPU and USB limits.
The RX888 MkII produces a real flood of bits: over 2Gb/s at a sample rate of 129.6 MHz, requiring that it use USB 3.
While a midrange x86 is enough to handle the processing requirements, they are not exactly insubstantial either so I recommend
only one per host.

In the excerpt above, the **hardware** entry in the [global] section specifies the section containing RX888 configuration
information. (In this example the name of the hardware section happens to be the same as the device type, but it is not essential.)

Only one entry is mandatory: **device**. This specifies the front end hardware type, i.e, "rx888", which means an RX-888 MkII.
The defaults should be good for most cases, but you can override them as needed.

**description** Optional. Free-format text that
will be advertised through the *radiod* program on the
control/status stream to the *control* program that
listens to it. It will also be advertised in DNS SRV (service
discovery) records by the Linux mDNS daemon *avahi*, so keep
it short but descriptive.

**number** Optional, default 0.
Selects the index of the RX-888 to use if there's more than one on the system. Probably won't do what you want since the order that multiple devices are enumerated is unpredictable.
It will be possible to select a unit by serial number but this isn't a high priority because it's unlikely you'll have more than one on a system.

**samprate** Integer, default 64,800,000 Hz (64.8 MHz). 
Sets the A/D sample rate. The RX-888 MkII is actually rated for 130 MHz but several users have had thermal problems so the default is to run it at half speed.

**gain** Decimal, default +1.5 dB.
Sets the gain of the AD8370 analog
VGA ahead of the A/D converter. There is no front end AGC in hardware or software (yet) so this
should be set with some care. Choose a value that results in an RMS
A/D output level of -20 to -25 dBFS. I generally use +10 dB and may
make this the default.

**att** Decimal, range 0 to 31.5 dB in 0.5 dB steps, default 0.
Sets the attenuation of the PE4312 attenuator ahead of the AD8370 variable gain amplifier.

**gainmode** String, either "high" or "low", default "high".
Sets the gain mode of the AD8370 variable gain amplifier. The gains available in the two modes overlap, but even at the same gain the noise figure in "low" mode is considerably higher (worse) than in high mode. Use gainmode=low only if resistance to strong signals (i.e., increasing the IP3) is especially important.

**bias** Boolean, default off. Enable the bias tee (preamplifier
power).

**calibrate** Decimal, default 0.
Sets the clock error fraction for
the built-in 27 MHz sampling clock. Not yet
implemented. (After-market modifications for an external GPSDO
reference are possible and recommended.)

**firmware** String, default "SDDC_FX3.img".
Specifies the path name of the firmware file to be loaded into the unit at startup. If not absolute it will be relative to /usr/local/share/ka9q-radio.

**queuedepth** Integer, default 16.
The number of buffers to be queued up for transfer over the USB.

**reqsize** Integer, default 32.
Sets the size of each transfer buffer in internal units, which apparently defaults to 16 KB. reqsize = 32 therefore corresponds to 512KB.

**dither** Boolean, default no.
Enables the built-in dither feature of the LTC2208 A/D converter. Doesn't seem necessary given that antenna noise is almost certainly much greater than the quantization
noise floor of this 16 bit A/D.

**rand** Boolean, default no.
Enables the data randomization feature of the LTC2208 A/D converter and automatically de-randomizes the data after reception. This is supposed to lower spurs. The actual benefit hasn't been measured, but the CPU cost is minimal.


